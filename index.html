<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>گالری آثار — نسرین هویدا</title>
<meta name="description" content="گالری آنلاین نسرین هویدا — طراحی، سبک مدرن هاشور، خلاقانه و آبرنگ، مدل های زنده و فیگوراتیو." />
<link rel="icon" href="data:;base64,iVBORw0KGgo=">

<style>
  /* ===== پایه ===== */
  :root{
    --bg:#fbf8f5;
    --card:#ffffff;
    --muted:#6b6b6b;
    --accent:#c36f3f; /* قهوه‌ای-نارنجی آرام */
    --accent-2:#f5b37b;
    --radius:14px;
    --gap:18px;
    font-family: "Vazirmatn", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color-scheme: light;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(180deg,#fffaf8 0%, #fbf7f4 60%); color:#222;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    padding:28px;
  }

  .container{
    max-width:1200px; margin:0 auto; display:grid;
    grid-template-columns: 320px 1fr; gap:var(--gap);
    align-items:start;
  }

  /* ===== سایدبار پروفایل ===== */
  .card{
    background:var(--card); border-radius:var(--radius);
    padding:20px; border:1px solid rgba(17,17,17,0.04);
    box-shadow: 0 8px 30px rgba(20,20,20,0.05);
  }
  .profile-photo{width:120px;height:120px;border-radius:50%;overflow:hidden;margin:0 auto 12px;box-shadow:0 8px 24px rgba(195,111,63,0.08)}
  .profile-photo img{width:100%;height:100%;object-fit:cover;display:block}
  h1.name{font-size:18px;margin:6px 0;text-align:center}
  .role{font-size:13px;color:var(--muted);text-align:center;margin-bottom:12px}

  .contact{font-size:13px;color:var(--muted);line-height:1.6;margin-top:6px}
  .contact a{color:var(--accent);text-decoration:none}

  .taglist{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:14px}
  .tag{background:linear-gradient(90deg,#fff,#fff);border:1px solid rgba(0,0,0,0.04);padding:7px 10px;border-radius:999px;font-size:12px;color:var(--muted)}

  .download-btn{
    display:block;margin:14px auto 0;padding:10px 16px;border-radius:10px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;text-decoration:none;text-align:center;font-weight:700;box-shadow:0 8px 18px rgba(195,111,63,0.12)
  }

  .cat-list{margin-top:16px;display:flex;flex-direction:column;gap:10px}
  .cat-btn{
    border-radius:10px;padding:10px;border:1px solid rgba(0,0,0,0.04);background:#fff;color:#222;text-align:center;font-weight:600;cursor:pointer;
  }
  .cat-btn.active{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff; box-shadow:0 10px 24px rgba(195,111,63,0.08) }

  /* ===== محتوای اصلی ===== */
  main{min-height:400px}
  .panel{background:transparent;border-radius:var(--radius);padding:0}
  header.main-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
  .main-title{font-size:20px;font-weight:800}
  .subtitle{color:var(--muted);font-size:14px}

  /* controls */
  .controls{display:flex;gap:12px;align-items:center}
  .search{padding:10px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);width:260px}
  .filter-btn{padding:10px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:#fff;cursor:pointer}

  /* gallery */
  .gallery-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:18px}
  .card-item{background:var(--card);border-radius:12px;overflow:hidden;border:1px solid rgba(0,0,0,0.04);box-shadow:0 8px 28px rgba(20,20,20,0.03);transition:transform .18s ease,box-shadow .18s ease}
  .card-item:hover{transform:translateY(-6px);box-shadow:0 20px 40px rgba(20,20,20,0.06)}
  .thumb{position:relative;width:100%;padding-bottom:70%;background:linear-gradient(135deg,#fff6f0,#fffdfb);display:flex;align-items:center;justify-content:center;overflow:hidden}
  .thumb img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
  .meta-box{padding:12px;border-top:1px solid rgba(0,0,0,0.03)}
  .meta-title{font-weight:700;color:#222}
  .meta-sub{font-size:13px;color:var(--muted);margin-top:6px}

  /* lightbox */
  .lightbox{
    position:fixed;inset:0;background:rgba(14,14,14,0.8);display:none;align-items:center;justify-content:center;z-index:9999;padding:24px;
  }
  .lightbox.show{display:flex}
  .lb-inner{max-width:1100px;width:100%;max-height:90vh;background:transparent;display:grid;grid-template-columns:1fr 360px;gap:16px;align-items:start}
  .lb-image{background:#000;height:100%;display:flex;align-items:center;justify-content:center;border-radius:10px;overflow:hidden}
  .lb-image img{max-width:100%;max-height:90vh;object-fit:contain;display:block}
  .lb-meta{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 12px 30px rgba(0,0,0,0.12);border:1px solid rgba(0,0,0,0.04)}
  .lb-title{font-weight:800;margin-bottom:8px}
  .lb-caption{color:var(--muted);font-size:14px}
  .lb-actions{display:flex;gap:10px;margin-top:12px;flex-wrap:wrap}
  .btn-light{padding:10px 12px;border-radius:10px;border:0;cursor:pointer;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;font-weight:700}

  /* empty / loading */
  .empty{padding:60px;text-align:center;color:var(--muted);font-size:15px}

  /* responsiveness */
  @media (max-width:920px){
    .container{grid-template-columns:1fr}
    .lb-inner{grid-template-columns:1fr}
    .profile-photo{margin-bottom:8px}
    .search{width:100%}
  }

  /* small rtl niceties */
  a,button{font-family:inherit}
</style>
</head>
<body>
  <div class="container">
    <!-- SIDEBAR -->
    <aside class="card" aria-label="پروفایل">
      <div class="profile-photo">
        <img src="nasrin_profile.jpg" alt="نسرین هویدا — پروفایل">
      </div>

      <h1 class="name">نسرین هویدا</h1>
      <div class="role">طراح و مدرس طراحی آکادمیک</div>

      <div class="contact">
        <div>تلفن: <strong>09196869919</strong></div>
        <div>ایمیل: <a href="mailto:nasrin.howaida@gmail.com">nasrin.howaida@gmail.com</a></div>
      </div>

      <div class="taglist" aria-hidden="false">
        <span class="tag">پرتره</span>
        <span class="tag">فیگور</span>
        <span class="tag">هاشور مدرن</span>
        <span class="tag">آبرنگ</span>
      </div>

      <a class="download-btn" href="CV_Nasrin Howaida.pdf" target="_blank" rel="noopener">دانلود رزومه (PDF)</a>

      <div style="margin-top:14px">
        <div style="font-weight:800;margin-bottom:8px;color:#333">دسته‌بندی‌ها</div>
        <div class="cat-list" id="category-list">
          <!-- دکمه‌ها توسط JS تولید می‌شوند -->
        </div>
      </div>
    </aside>

    <!-- MAIN -->
    <main>
      <section class="panel">
        <header class="main-head">
          <div>
            <div class="main-title">گالری آثار — نسرین هویدا</div>
            <div class="subtitle">طراحی | سبک مدرن هاشور | خلاقانه و آبرنگ | مدل های زنده و فیگوراتیو</div>
          </div>
          <div class="controls">
            <input id="search" class="search" placeholder="جستجوی عنوان یا نام فایل..." />
            <button id="btn-refresh" class="filter-btn" title="بارگذاری دوباره">بارگذاری</button>
          </div>
        </header>

        <div id="gallery" class="gallery-grid" aria-live="polite">
          <div class="empty" id="loading">در حال بارگذاری تصاویر ...</div>
        </div>
      </section>
    </main>
  </div>

  <!-- LIGHTBOX -->
  <div id="lightbox" class="lightbox" role="dialog" aria-hidden="true">
    <div class="lb-inner" role="document">
      <div class="lb-image">
        <img id="lb-img" src="" alt="">
      </div>
      <div class="lb-meta">
        <div class="lb-title" id="lb-title"></div>
        <div class="lb-caption" id="lb-caption"></div>
        <div class="lb-actions">
          <button id="prev-btn" class="btn-light">قبلی</button>
          <button id="next-btn" class="btn-light">بعدی</button>
          <a id="download-btn" class="btn-light" href="#" download>دانلود تصویر</a>
          <button id="close-btn" class="btn-light" style="background:#f3f3f3;color:#222">بستن</button>
        </div>
      </div>
    </div>
  </div>

<script>
/*
  index.html gallery loader
  - خواندن نام فولدرها: لیست ثابت زیر (همین نام‌ها در ریپو باید موجود باشند)
  - برای هر فولدر، فایل manifest.json را می‌خواند
  - دو فرمت پشتیبانی می‌شود: آرایه ساده یا آبجکت با کلید images
  - سپس گرید را پر می‌کند، دسته‌ها ساخته می‌شوند، لایت‌باکس فعال است
*/

const FOLDERS = [
  { key: 'Tarahi', label: 'طراحی' },
  { key: 'Modern_Hashour', label: 'سبک مدرن هاشور' },
  { key: 'Khalaghane_Abrang', label: 'خلاقانه و آبرنگ' },
  { key: 'Model_Figurative', label: 'مدل‌های زنده و فیگوراتیو' }
];

const galleryEl = document.getElementById('gallery');
const loadingEl = document.getElementById('loading');
const catListEl = document.getElementById('category-list');
const searchInput = document.getElementById('search');
const refreshBtn = document.getElementById('btn-refresh');

// lightbox
const lightbox = document.getElementById('lightbox');
const lbImg = document.getElementById('lb-img');
const lbTitle = document.getElementById('lb-title');
const lbCaption = document.getElementById('lb-caption');
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');
const downloadBtn = document.getElementById('download-btn');
const closeBtn = document.getElementById('close-btn');

let allItems = []; // { folder, filename, src, title }
let visibleItems = [];
let currentIndex = -1;
let activeCategory = null;

function safeName(filename){
  // human-friendly title: remove extension and underscores / numbers common in your files
  const name = filename.replace(/\.(jpe?g|png|webp|gif)$/i,'')
                       .replace(/[_-]+/g,' ')
                       .replace(/\b58732074852655\b/g,'')
                       .replace(/\s+/g,' ')
                       .trim();
  return name || filename;
}

async function loadManifests(){
  allItems = [];
  galleryEl.innerHTML = '';
  loadingEl.style.display = 'block';
  loadingEl.textContent = 'در حال بارگذاری تصاویر ...';

  for(const f of FOLDERS){
    try{
      const url = `${f.key}/manifest.json`;
      const r = await fetch(url, {cache: "no-store"});
      if(!r.ok){
        console.warn('manifest not found for', f.key, r.status);
        continue;
      }
      const json = await r.json();
      // support two shapes: array or { images: [...] } or { "images": [...] } or { "images": {..} }
      let files = [];
      if(Array.isArray(json)) files = json;
      else if(Array.isArray(json.images)) files = json.images;
      else if(Array.isArray(json.images?.images)) files = json.images.images;
      else {
        // if object keys look like filenames, collect them
        const maybe = Object.values(json).flat ? Object.values(json).flat() : [];
        if(Array.isArray(maybe) && maybe.length) files = maybe;
      }

      files = files.filter(Boolean);
      files.forEach(fn=>{
        const src = `${f.key}/${fn}`;
        allItems.push({
          folder: f.key,
          filename: fn,
          src,
          title: safeName(fn),
          category: f.label
        });
      });
    }catch(err){
      console.error('error reading manifest for', f.key, err);
    }
  }

  if(allItems.length === 0){
    loadingEl.textContent = 'فعلاً تصویری برای نمایش وجود ندارد. لطفاً فایل manifest.json و تصاویر را بررسی کن.';
    return;
  }

  // build categories UI
  renderCategories();

  // initial render all
  visibleItems = allItems.slice();
  renderGallery();
}

function renderCategories(){
  catListEl.innerHTML = '';
  // All button
  const btnAll = document.createElement('button');
  btnAll.className = 'cat-btn active';
  btnAll.textContent = 'همه';
  btnAll.addEventListener('click', ()=>{ setCategory(null); });
  catListEl.appendChild(btnAll);

  FOLDERS.forEach(f=>{
    const btn = document.createElement('button');
    btn.className = 'cat-btn';
    btn.textContent = f.label;
    btn.addEventListener('click', ()=>{ setCategory(f.key); });
    btn.dataset.folder = f.key;
    catListEl.appendChild(btn);
  });
}

function setCategory(folderKey){
  activeCategory = folderKey;
  // toggle UI
  document.querySelectorAll('.cat-btn').forEach(b=>{
    b.classList.remove('active');
    if((!folderKey && b.textContent === 'همه') || b.dataset.folder === folderKey) b.classList.add('active');
  });
  filterAndRender();
}

function filterAndRender(){
  const q = (searchInput.value || '').trim().toLowerCase();
  visibleItems = allItems.filter(it=>{
    if(activeCategory && it.folder !== activeCategory) return false;
    if(q){
      return it.title.toLowerCase().includes(q) || it.filename.toLowerCase().includes(q);
    }
    return true;
  });
  renderGallery();
}

function renderGallery(){
  galleryEl.innerHTML = '';
  if(!visibleItems.length){
    const e = document.createElement('div');
    e.className = 'empty';
    e.textContent = 'موردی پیدا نشد.';
    galleryEl.appendChild(e);
    loadingEl.style.display = 'none';
    return;
  }

  visibleItems.forEach((it, idx)=>{
    const el = document.createElement('article');
    el.className = 'card-item';
    el.tabIndex = 0;

    const thumb = document.createElement('div');
    thumb.className = 'thumb';
    const img = document.createElement('img');
    img.alt = it.title;
    img.src = it.src;
    img.loading = 'lazy';
    img.onerror = function(){
      // fallback: tiny placeholder
      this.style.display='none';
      const ph = document.createElement('div');
      ph.style.padding='12px';
      ph.style.color='var(--muted)';
      ph.style.fontWeight='700';
      ph.textContent = it.title;
      thumb.appendChild(ph);
    };
    thumb.appendChild(img);

    const meta = document.createElement('div');
    meta.className = 'meta-box';
    const t = document.createElement('div'); t.className='meta-title'; t.textContent = it.title || it.filename;
    const s = document.createElement('div'); s.className='meta-sub'; s.textContent = `${it.category} — ${it.filename}`;
    meta.appendChild(t); meta.appendChild(s);

    el.appendChild(thumb);
    el.appendChild(meta);

    // click open lightbox with index relative to visibleItems
    el.addEventListener('click', ()=> openLightbox(idx) );
    el.addEventListener('keypress', (e)=>{ if(e.key === 'Enter') openLightbox(idx); });

    galleryEl.appendChild(el);
  });

  loadingEl.style.display = 'none';
}

/* Lightbox actions (indexes are in visibleItems array) */
function openLightbox(idx){
  currentIndex = idx;
  const item = visibleItems[currentIndex];
  if(!item) return;
  lbImg.src = item.src;
  lbTitle.textContent = item.title || item.filename;
  lbCaption.textContent = `${item.category} — ${item.filename}`;
  downloadBtn.href = item.src;
  downloadBtn.setAttribute('download', item.filename);
  lightbox.classList.add('show');
  lightbox.setAttribute('aria-hidden','false');
}
function closeLightbox(){
  lightbox.classList.remove('show');
  lightbox.setAttribute('aria-hidden','true');
  lbImg.src = '';
  currentIndex = -1;
}
function prevImage(){
  if(currentIndex <= 0) currentIndex = visibleItems.length - 1;
  else currentIndex--;
  openLightbox(currentIndex);
}
function nextImage(){
  if(currentIndex >= visibleItems.length - 1) currentIndex = 0;
  else currentIndex++;
  openLightbox(currentIndex);
}

/* events */
prevBtn.addEventListener('click', prevImage);
nextBtn.addEventListener('click', nextImage);
closeBtn.addEventListener('click', closeLightbox);
lightbox.addEventListener('click', (e)=>{ if(e.target === lightbox) closeLightbox(); });
document.addEventListener('keydown', (e)=>{
  if(!lightbox.classList.contains('show')) return;
  if(e.key === 'Escape') closeLightbox();
  if(e.key === 'ArrowLeft') prevImage();
  if(e.key === 'ArrowRight') nextImage();
});

searchInput.addEventListener('input', ()=> filterAndRender());
refreshBtn.addEventListener('click', ()=> loadManifests());

/* on load */
loadManifests();

/* small polish: if manifest.json changed in repo, فشار دادن F5 یا دکمه بارگذاری مجدداً خوانش می‌کند */
</script>

</body>
</html>
